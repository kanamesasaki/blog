{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/20220209-jest/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"ae8c5893-2cf0-579e-bec4-c1fd956fb064","excerpt":"やりたいこと JavaScriptまたはTypeScriptのES6モジュールをJestテストする方法のメモです． Jestの設定（JavaScriptの場合） Jestをインストールする． package.jsonファイル内に”script”と”type”のスクリプトを追加する． jest.config.js…","html":"<h2>やりたいこと</h2>\n<p>JavaScriptまたはTypeScriptのES6モジュールをJestテストする方法のメモです．</p>\n<h2>Jestの設定（JavaScriptの場合）</h2>\n<p>Jestをインストールする．</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev jest</code></pre></div>\n<p>package.jsonファイル内に”script”と”type”のスクリプトを追加する．</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"directories\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"test\"</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node --experimental-vm-modules node_modules/jest/bin/jest.js\"</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"module\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^26.6.3\"</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>jest.config.jsファイルを作成し，以下のスクリプトを書き込む．</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\r\n  testEnvironment<span class=\"token operator\">:</span> <span class=\"token string\">'jest-environment-node'</span><span class=\"token punctuation\">,</span>\r\n  transform<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>以下のコマンドでJestテストを実行する．</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token builtin class-name\">test</span></code></pre></div>\n<h2>Jestの設定（TypeScriptの場合）</h2>\n<p>Jestと関連するモジュールをインストールする．</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev jest ts-jest @types/jest</code></pre></div>\n<p>以下のコマンドでjest.configファイルを作成する．\r\njest.configファイルをTypeScriptにすると，ts-nodeが追加で必要になるので，JavaScriptを指定する．</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npx jest --init\r\n\r\n√ Would you like to use Typescript <span class=\"token keyword\">for</span> the configuration file? <span class=\"token punctuation\">..</span>. no\r\n√ Choose the <span class=\"token builtin class-name\">test</span> environment that will be used <span class=\"token keyword\">for</span> testing » node\r\n√ Do you want Jest to <span class=\"token function\">add</span> coverage reports? <span class=\"token punctuation\">..</span>. <span class=\"token function\">yes</span>\r\n√ Which provider should be used to instrument code <span class=\"token keyword\">for</span> coverage? » v8\r\n√ Automatically <span class=\"token function\">clear</span> mock calls, instances and results before every test? <span class=\"token punctuation\">..</span>. no</code></pre></div>\n<p>jest.config.jsに以下のスクリプトを追加する．</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token comment\">// The glob patterns Jest uses to detect test files</span>\r\n  testMatch<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token string\">\"**/__tests__/**/*.[jt]s?(x)\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">\"**/?(*.)+(spec|test).[tj]s?(x)\"</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token comment\">// A map from regular expressions to paths to transformers</span>\r\n  transform<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token string\">\"^.+\\\\.(ts|tsx)$\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-jest\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>package.jsonファイルに以下のスクリプトを追加．</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"jest\"</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>tsconfig.jsonファイルにはesModuleInteropのスクリプトを追加．</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n\t<span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"es6\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dom\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es6\"</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es6\"</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token property\">\"allowJs\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\r\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t<span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n\t\t<span class=\"token string\">\"src\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lib\"</span>\r\n\t<span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>以下のコマンドでJestテストを実行する．</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token builtin class-name\">test</span></code></pre></div>","frontmatter":{"title":"ES6モジュールをJestテストする","date":"February 09, 2022","description":"Jest testing environment for JavaScript/TypeScript ES6 modules"}},"previous":{"fields":{"slug":"/20220130-reflection/"},"frontmatter":{"title":"拡散反射と鏡面反射のモデル化"}},"next":{"fields":{"slug":"/20220215-disk-viewfactor/"},"frontmatter":{"title":"微小表面から円板への形態係数（View Factor）"}}},"pageContext":{"id":"ae8c5893-2cf0-579e-bec4-c1fd956fb064","previousPostId":"ce2f28da-4dd3-5876-a566-f04a5bb19b32","nextPostId":"2a4f082a-23ae-5e18-afdb-89a153314bb8"}},
    "staticQueryHashes": ["2841359383","3257411868"]}